---

title: updates: Strategies for updating parameters


keywords: fastai
sidebar: home_sidebar



nb_path: "02_updates.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 02_updates.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The various update rules that can be used by the <code>[`GradientDescent`](/gradless/optimizers.html#GradientDescent)</code> optimizer are collected here. <code>[`GradientDescent`](/gradless/optimizers.html#GradientDescent)</code> expects update rules to by instances of a class with an <code>evaluate</code> method that takes as input a gradient estimate, a learning rate, and the current iteration (Comment: this seems like a suboptimal requirement), and returns a proposed parameter update. The reason update rules are required to be structured as classes is so that they can store any information they need to update the parameters. All update rules should return a numpy array of floats to be used as a step to update the model parameters.</p>
<p>Many of the update steps are implemented based on <a href="https://arxiv.org/abs/1609.04747">this review</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="UpdateBase" class="doc_header"><code>class</code> <code>UpdateBase</code><a href="https://github.com/LaptopBiologist/gradless/tree/master/gradless/updates.py#L12" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>UpdateBase</code>() :: <code>ABC</code></p>
</blockquote>
<p>A helper class for constructing update rules</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(Note: I may want to do some restructuring and move the parameter stepsize, decay to the update rules)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-standard-SPSA-step">The standard SPSA step<a class="anchor-link" href="#The-standard-SPSA-step"> </a></h3><p>The default step used by Spall's classic SPSA algorithm is</p>
<p>{% raw %}
$$\theta_{t+1}=\theta_t - a_t \hat{g}$$
{% endraw %}</p>
<p>where $\hat{g}$ is the gradient estimate and $a_t$ is the learning rate at iteration $t$.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="StandardSPSA" class="doc_header"><code>class</code> <code>StandardSPSA</code><a href="https://github.com/LaptopBiologist/gradless/tree/master/gradless/updates.py#L20" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>StandardSPSA</code>() :: <a href="/gradless/updates.html#UpdateBase"><code>UpdateBase</code></a></p>
</blockquote>
<p>A standard gradient descent update.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-ADAGRAD-step-update">The ADAGRAD step update<a class="anchor-link" href="#The-ADAGRAD-step-update"> </a></h3><p>ADAGRAD</p>
<p>The update rule is
{% raw %}
$$G_0=0$$
{% endraw %}
{% raw %}
$$G_t=G_{t-1}+(\hat{g}_t)^2$$
{% endraw %}
{% raw %}
$$\theta_{t+1}=\theta_t - a_t \frac{\hat{g}_t}{\sqrt{G_t}+\epsilon} $$
{% endraw %}</p>
<p>This step update requires a small term <code>eps</code> be defined to prevent divide be zero errors. By default this is set to <code>1e-8</code></p>
<p>Note that typically, ADAGRAD is employed with a fixed learning rate. By default, however, <code>[`GradientDescent`](/gradless/optimizers.html#GradientDescent)</code> uses a decreasing serir</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ADAGRAD" class="doc_header"><code>class</code> <code>ADAGRAD</code><a href="https://github.com/LaptopBiologist/gradless/tree/master/gradless/updates.py#L30" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ADAGRAD</code>(<strong><code>eps</code></strong>=<em><code>1e-08</code></em>) :: <a href="/gradless/updates.html#UpdateBase"><code>UpdateBase</code></a></p>
</blockquote>
<p>The Adagrad gradient descent update.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-ADAM-step-update">The ADAM step update<a class="anchor-link" href="#The-ADAM-step-update"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Adaptive Moment Estimation (Adam)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ADAM" class="doc_header"><code>class</code> <code>ADAM</code><a href="https://github.com/LaptopBiologist/gradless/tree/master/gradless/updates.py#L43" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ADAM</code>(<strong><code>beta1</code></strong>=<em><code>0.9</code></em>, <strong><code>beta2</code></strong>=<em><code>0.999</code></em>, <strong><code>eps</code></strong>=<em><code>1e-08</code></em>) :: <a href="/gradless/updates.html#UpdateBase"><code>UpdateBase</code></a></p>
</blockquote>
<p>A helper class for constructing update rules</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Nestorov-accelerated-ADAM-step-update">The Nestorov-accelerated ADAM step update<a class="anchor-link" href="#The-Nestorov-accelerated-ADAM-step-update"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NADAM" class="doc_header"><code>class</code> <code>NADAM</code><a href="https://github.com/LaptopBiologist/gradless/tree/master/gradless/updates.py#L64" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NADAM</code>(<strong><code>beta1</code></strong>=<em><code>0.9</code></em>, <strong><code>beta2</code></strong>=<em><code>0.999</code></em>, <strong><code>eps</code></strong>=<em><code>1e-08</code></em>) :: <a href="/gradless/updates.html#UpdateBase"><code>UpdateBase</code></a></p>
</blockquote>
<p>A helper class for constructing update rules</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

